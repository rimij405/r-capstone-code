#!/usr/bin/env bash

# Installation directory.
SCRIPT_DIR="$(realpath "${0%/*}")"
INSTALL_DIR="$(realpath "${SCRIPT_DIR}/../inst")"

# Ensure installation directory exists.
if [ ! -d "${INSTALL_DIR}" ]; then
  mkdir -p  "${INSTALL_DIR}"
fi

# Copy files into the `inst/` directory.
files=("_targets.R" "CHANGELOG.md" "CITATION" "CITATION.cff")

for file in "${files[@]}"; do
  cp "${SCRIPT_DIR}/../${file}" "${INSTALL_DIR}/${file}"
done

# Run check.
/usr/bin/R --no-echo --no-restore -e "devtools::check()" |
    tee rcmdcheck.log
